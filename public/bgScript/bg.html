<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://use.typekit.net/uok8swb.css">
  <link rel="stylesheet" type="text/css" href="./base.css"/>
</head>
<body>
<div class="content" id="observeScan">
  <div id="app"></div>
  <div class="content__title-wrap">
    <h2 class="content__title"><span>“We”</span><span>build</span> <span>the</span> <span>Future</span></h2>
    <p class="content__desc">
      <span>Provide</span> <span>a</span> <span>decentralized,</span> <span>participatory</span> <span>Web3.0</span> <span>storage</span> <span>solution</span> <span>for</span> <span>everyone.</span>
    </p>
  </div>
</div>
<script src="./three.min.js"></script>
<script src="./postprocessing.min.js"></script>
<script src="./InfiniteLights.js"></script>
<script src="./Distortions.js"></script>
<script>

  (function () {

    const container = document.getElementById('app');

    const options = {
      onSpeedUp: (ev) => {
      },
      onSlowDown: (ev) => {
      },
      // mountainDistortion || LongRaceDistortion || xyDistortion || turbulentDistortion || turbulentDistortionStill || deepDistortionStill || deepDistortion
      distortion: turbulentDistortion,

      length: 400,
      roadWidth: 10,
      islandWidth: 2,
      lanesPerRoad: 3,

      fov: 90,
      fovSpeedUp: 150,
      speedUp: 2,
      carLightsFade: 0.4,

      totalSideLightSticks: 20,
      lightPairsPerRoadWay: 40,

      // Percentage of the lane's width
      shoulderLinesWidthPercentage: 0.05,
      brokenLinesWidthPercentage: 0.1,
      brokenLinesLengthPercentage: 0.5,

      /*** These ones have to be arrays of [min,max].  ***/
      lightStickWidth: [0.12, 0.5],
      lightStickHeight: [1.3, 1.7],

      movingAwaySpeed: [60, 80],
      movingCloserSpeed: [-120, -160],

      /****  Anything below can be either a number or an array of [min,max] ****/

      // Length of the lights. Best to be less than total length
      carLightsLength: [400 * 0.03, 400 * 0.2],
      // Radius of the tubes
      carLightsRadius: [0.05, 0.14],
      // Width is percentage of a lane. Numbers from 0 to 1
      carWidthPercentage: [0.3, 0.5],
      // How drunk the driver is.
      // carWidthPercentage's max + carShiftX's max -> Cannot go over 1.
      // Or cars start going into other lanes
      carShiftX: [-0.8, 0.8],
      // Self Explanatory
      carFloorSeparation: [0, 5],

      colors: {
        roadColor: 0x0A0913,
        islandColor: 0x0A0913,
        background: 0x0A0913,
        shoulderLines: 0x0A0913,
        brokenLines: 0x0A0913,
        /***  Only these colors can be an array ***/
        leftCars: [0x8578E6, 0x8578E6, 0x8578E6],
        rightCars: [0x8578E6, 0x8578E6, 0x8578E6],
        sticks: 0x0A0913,
      }
    };

    const myApp = new App(container, options);
    myApp.loadAssets().then(myApp.init)

    const observeId = document.getElementById('observeScan')
    if (observeId) {
      const observe = new IntersectionObserver((entries, observer) => {
        let percent_ = entries[0].intersectionRatio * 100;
        if (percent_ === 0 && myApp.running) {
          myApp.stop()
        } else if (percent_ > 0 && !myApp.running) {
          myApp.start()
        }
      }, {
        root: null,
        rootMargin: '0px',
        threshold: [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1],
      });
      observe.observe(observeId)
    }


  })()
</script>
</body>
</html>
